---
title: "Downloading and Processing POLIS Data"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Downloading and Processing POLIS Data}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>")
```

```{r setup, echo=FALSE}
library(tidypolis)
```

## Introduction

The Surveillance, Innovation, and Research (SIR) Team within the Polio Eradication Branch at CDC obtains global polio data from [POLIS](https://extranet.who.int/polis/Account/Login). Collaborators outside of CDC who wish to download and process global polio data using the tidypolis package must have access to POLIS beforehand, as well obtain a POLIS API key.

This guide is tailored for collaborators who wish to use the sirfunctions package to analyze global polio data and have access to data in POLIS.

## Getting Started
Ensure that you have a valid POLIS API key, this can be obtained by contacting **Minh-Ly Pham** [phamm\@who.int](mailto:phamm@who.int){.email} 

### Setting up your POLIS folder {#polis-folder-setup}
Choose a location for your POLIS data folder on your local machine, it is suggested that you keep this folder on your desktop.

```
library(tidypolis)
init_tidypolis <- (
    polis_folder = "path/to/POLIS", #replace with your file path
    edav = F, #keep as F
    api_debug = F #set to T to log individual API calls
    )
```

This function will create a POLIS folder if one doesn't exist or connect to an already existing POLIS folder. If creating a folder you will be required to supply a valid POLIS API key. If the folder already exists your API key will be validated with POLIS. (Note: if POLIS is offline for any reason, ie maintenance, you will be unable to validate your API key)

In creating your POLIS folder your API key will be stored in 'creds.rds' within your POLIS folder

### Downloading Global Polio Data {#download-polis-data}
Once you've created or connected to a POLIS folder you can download data via the POLIS API.

```
 get_polis_data()
```
Running this function will download the following tables:

1. activity
2. case
3. environmental_sample
4. human_specimen
5. im
6. lqas
7. sub_activity
8. virus

The first download will pull the entirety of each table. Subsequent downloads will only pull updated records for tables that contain a unique identifier and updated date fields. 

POLIS population data can also be downloaded with `get_polis_data()`

```
get_polis_data(type = "pop)
```

This will download the population dataset into the same location as the other POLIS tables.

